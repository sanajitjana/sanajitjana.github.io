(()=>{var a=class{constructor(){this.theme=localStorage.getItem("theme")||"system",this.colorScheme=localStorage.getItem("colorScheme")||document.documentElement.getAttribute("data-theme")||"default",this.init()}init(){this.setupEventListeners(),this.updateUI()}setupDropdown(e){let o=`.dropdown-toggle[data-dropdown-type="${e}"]`,t=`.dropdown-menu[data-dropdown-type="${e}"]`,s=document.querySelectorAll(o),n=document.querySelectorAll(t);s.forEach((c,r)=>{let d=n[r]||n[0];c&&d&&c.addEventListener("click",m=>{m.stopPropagation(),this.closeOtherMenus(e),document.querySelectorAll(t).forEach(l=>{if(l!==d){l.classList.add("hidden");let i=document.querySelector(`${o}[aria-labelledby="${l.getAttribute("aria-labelledby")}"], ${o}[aria-controls="${l.id}"]`);i&&i.setAttribute("aria-expanded","false")}});let h=d.classList.contains("hidden");d.classList.toggle("hidden"),c.setAttribute("aria-expanded",h?"true":"false"),e==="mobile-menu"&&this.handleMobileMenuClick(d,c)})})}closeOtherMenus(e){["color-scheme","theme","language","mobile-menu"].forEach(t=>{t!==e&&document.querySelectorAll(`.dropdown-menu[data-dropdown-type="${t}"]`).forEach(s=>{s.classList.add("hidden");let n=document.querySelector(`.dropdown-toggle[data-dropdown-type="${t}"]`);n&&n.setAttribute("aria-expanded","false")})})}closeAllDropdowns(){document.querySelectorAll(".dropdown-menu").forEach(e=>{e.classList.add("hidden");let o=e.getAttribute("data-dropdown-type");if(o){let t=document.querySelector(`.dropdown-toggle[data-dropdown-type="${o}"]`);t&&t.setAttribute("aria-expanded","false")}})}closeMobileMenu(){let e=document.getElementById("mobile-menu"),o=document.getElementById("mobile-menu-toggle");e&&e.classList.add("hidden"),o&&o.setAttribute("aria-expanded","false")}closeAllMenus(){this.closeAllDropdowns()}handleMobileMenuClick(e,o){e.addEventListener("click",t=>{t.target.closest("a[href]")&&setTimeout(()=>{e.classList.add("hidden"),o.setAttribute("aria-expanded","false")},100)})}setupMobileMenu(){console.log("\u79FB\u52A8\u7AEF\u83DC\u5355\u4F7F\u7528\u7EDF\u4E00\u7684\u4E0B\u62C9\u83DC\u5355\u5904\u7406\u903B\u8F91")}setupEventListeners(){this.setupDropdown("mobile-menu"),this.setupDropdown("color-scheme"),this.setupDropdown("theme"),this.setupDropdown("language"),document.querySelectorAll('.dropdown-menu[data-dropdown-type="color-scheme"]').forEach(t=>{t&&t.addEventListener("click",s=>{let n=s.target.closest("[data-color-scheme]");if(n){let c=n.getAttribute("data-color-scheme");this.setColorScheme(c),this.closeAllMenus()}})}),document.querySelectorAll('.dropdown-menu[data-dropdown-type="theme"]').forEach(t=>{t&&t.addEventListener("click",s=>{let n=s.target.closest("[data-theme]");if(n){let c=n.getAttribute("data-theme");this.setTheme(c),this.closeAllMenus()}})}),document.addEventListener("click",t=>{t.target.closest(".dropdown-toggle, .dropdown-menu")||this.closeAllMenus()}),document.addEventListener("keydown",t=>{t.key==="Escape"&&this.closeAllMenus()}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{this.theme==="system"&&(this.applyTheme(),this.updateUI())})}setColorScheme(e){this.colorScheme=e,localStorage.setItem("colorScheme",e),document.documentElement.setAttribute("data-theme",e),this.updateUI(),window.dispatchEvent(new CustomEvent("themeChanged",{detail:{colorScheme:e,theme:this.theme}}))}setTheme(e){this.theme=e,localStorage.setItem("theme",e),this.applyTheme(),this.updateUI(),window.dispatchEvent(new CustomEvent("themeChanged",{detail:{colorScheme:this.colorScheme,theme:e}}))}applyTheme(){this.theme==="dark"||this.theme==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}updateUI(){let e=document.querySelectorAll(".sun-icon, #sun-icon"),o=document.querySelectorAll(".moon-icon, #moon-icon"),t=document.querySelectorAll(".system-icon, #system-icon");[...e,...o,...t].forEach(s=>{s&&s.classList.add("hidden")}),this.theme==="light"?e.forEach(s=>s.classList.remove("hidden")):this.theme==="dark"?o.forEach(s=>s.classList.remove("hidden")):this.theme==="system"&&t.forEach(s=>s.classList.remove("hidden")),this.updateDropdownSelection()}updateDropdownSelection(){document.querySelectorAll("[data-color-scheme]").forEach(o=>{let t=o.getAttribute("data-color-scheme")===this.colorScheme;o.classList.toggle("bg-accent",t),o.classList.toggle("text-accent-foreground",t)}),document.querySelectorAll("[data-theme]").forEach(o=>{let t=o.getAttribute("data-theme")===this.theme;o.classList.toggle("bg-accent",t),o.classList.toggle("text-accent-foreground",t)});let e=document.documentElement.lang||"en";document.querySelectorAll('.dropdown-menu[data-dropdown-type="language"] a[role="menuitem"]').forEach(o=>{let t=o.getAttribute("href"),s=this.isCurrentLanguageLink(t,e);o.classList.toggle("bg-accent",s),o.classList.toggle("text-accent-foreground",s)})}isCurrentLanguageLink(e,o){return e==="/"&&o==="en"?!0:new RegExp(`^/${o}(/|$)`).test(e)}};document.addEventListener("DOMContentLoaded",()=>{new a});console.log("Hugo site with advanced UI management loaded.");})();
